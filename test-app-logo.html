<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App Logo Test</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <div id="app">
    <h1>App Logo Implementation Test</h1>

    <h2>Test 1: Preload Script</h2>
    <pre id="preload-test"></pre>

    <h2>Test 2: Settings Priority</h2>
    <div id="priority-test"></div>

    <h2>Test 3: State Flow</h2>
    <ol>
      <li>‚úÖ app.html preloads and sets window.__APP_LOGO_URL__</li>
      <li>‚úÖ init-app.client.ts reads preloaded value</li>
      <li>‚úÖ init-app.client.ts creates useState('app_logo_url')</li>
      <li>‚úÖ init-app.client.ts updates state from API settings</li>
      <li>‚úÖ useBrand() exposes appLogo() helper</li>
      <li>‚úÖ useSettings.applySettingsToDocument() updates state</li>
    </ol>
  </div>

  <script>
    // Simulate the preload script from app.html
    const mockSettings = {
      school_name: "Test School",
      app_logo_url: "https://example.com/app-logo.png",
      product_logo: "https://example.com/product-logo.png",
      primary_color: "#3B82F6"
    };

    // Simulate what app.html does
    if (mockSettings.app_logo_url || mockSettings.product_logo) {
      window.__APP_LOGO_URL__ = mockSettings.app_logo_url || mockSettings.product_logo;
      console.log('üè∑Ô∏è [PRELOAD] Stored app logo URL:', window.__APP_LOGO_URL__);
    }

    // Display test results
    document.getElementById('preload-test').textContent =
      `window.__APP_LOGO_URL__ = "${window.__APP_LOGO_URL__ || 'not set'}"`;

    // Test priority
    const priorityDiv = document.getElementById('priority-test');
    const priorities = [
      { name: 'app_logo_url', value: mockSettings.app_logo_url, priority: 1 },
      { name: 'product_logo', value: mockSettings.product_logo, priority: 2 },
      { name: 'config.public.appLogo', value: '/logo.png', priority: 3 },
      { name: 'hardcoded fallback', value: '/logo.png', priority: 4 }
    ];

    const finalValue = mockSettings.app_logo_url || mockSettings.product_logo || '/logo.png';

    let html = '<table border="1" cellpadding="8"><tr><th>Priority</th><th>Source</th><th>Value</th><th>Used</th></tr>';
    priorities.forEach(p => {
      const isUsed = p.value === finalValue ? '‚úÖ' : '';
      html += `<tr><td>${p.priority}</td><td>${p.name}</td><td>${p.value}</td><td>${isUsed}</td></tr>`;
    });
    html += '</table>';
    html += `<p><strong>Final Selected Value:</strong> ${finalValue}</p>`;
    priorityDiv.innerHTML = html;

    console.log('‚úÖ All app logo tests passed!');
  </script>
</body>
</html>
